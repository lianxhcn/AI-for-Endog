
## R1

Prof Hansen 想要给博士生和青年教师做一个 3 小时的讲座，介绍如何借助 Claude，ChatGPT 等 AI 工具应对学术研究中遇到的内生性问题。 

听众：博士生和青年教师，主要是经济管理和金融领域。知识背景：有一定的计量经济学基础，但对内生性问题的理解还比较浅显。

希望达到的目标：
- 帮助听众建立使用 AI 工具识别内生性问题的思路
- 演示如何使用 AI 工具设计解决内生性问题的方法 (如 IV, DID 等)。一定要基于具体的问题，提供可操作的提示词 (prompts)，而不是泛泛而谈。
- 提供一些基本原则，帮助听众评估 AI 工具生成的内容的可靠性和有效性
- 提供几组具有一定适用性的提示词 (prompts)，以便听众可以在自己的研究中直接使用
- 告知听众借助 AI 提升分析效率的基础：
  - 充分了解自己的研究问题和数据背景
  - 熟悉常用的因果推断方法，知晓它们的核心假设条件、使用场景和不适用场景
  - 掌握一定的编程技能 (如 Stata, R, Python 等)，以便将 AI 生成的代码片段整合到自己的分析流程中
  - 精读过一些经典论文，最好能做过复现，以便理解论文中的研究设计和方法论细节

请帮他规划一下，该如何准备这个讲座的内容？


## R2 

我的想法：以一个具体的研究问题 (政府引导基金介入对企业供应链稳定性的影响) 或某篇实证论文为例，演示如何使用 AI 工具来识别和解决内生性问题。

- 介绍实证研究中常见的内生性来源：
  - 遗漏变量
  - 反向因果
  - 样本选择偏差 / 自选择偏差
  - 测量误差
  - Notes：
    - 这些内容是为了后续使用 AI 工具写提示词做准备，提示词必须要有一定的针对性
    - 在论文中，要基于具体的研究问题和数据背景，来识别可能存在的内生性来源。这样才能有针对性地设计解决方案。也更能让审稿人信服我们解决内生性的思路是「设计」和「应对」，而不是「摆 Pose」或仅仅参考前期文献「照猫画虎」
  
- 介绍常见的解决内生性问题的方法：
  - 控制变量法
    - e.g, 固定效应，TWFE，交互固定效应
    - 重点：
      - 从解释「混淆变量」、「辛普森悖论」、「后门法则」等概念，这为选择 Good Controls 奠定理论基础；与此同时，可以简要介绍 Bad Controls 的概念，避免误用
  - 工具变量法 (IV)
    - e.g, 2SLS, LIML, GMM
    - 重点：
      - 解释 IV 的核心假设 (相关性和外生性)，以及常见的检验方法 (弱 IV 检验，过度识别检验)
      - 排他性解释和检验需要结合具体的研究背景，同时还要求对相关文献有足够的掌握 (这样你才能列举出可能违反排他性假设的路径，并设计相应的检验。一种主要的方法就是控制更多的变量，看看结果是否稳健)
      - **寻找合适的 IV**：
        - 这是 IV 方法中最难的部分。可以介绍一些常见的寻找 IV 的思路 (自然实验，政策变动，地理或历史变量等)，并强调需要结合具体的研究背景和数据。
        - 可以演示如何使用 AI 工具 (如 ChatGPT, Claude) 来生成寻找 IV 的提示词 (prompts)，并展示一些生成的 IV 候选变量。参考：
          - 张弛, 2025, [找不到IV？如何借助大语言模型寻找工具变量](https://www.lianxh.cn/details/1575.html).
      - **基于设计思想构造 IV**：这是以 Shift-Share IV/Bartik 为代表的一类方法。可以介绍其基本原理和应用场景，并演示如何使用 AI 工具来生成相关的提示词 (prompts)。
        - 类似的 IV 构造方法还包括：Judge IV, Sibling IV 等
  - 双重差分法 (DID)
    - 重点：
      - 解释 DID 的核心假设 (平行趋势假设)，以及常见的检验方法 (平行趋势检验，安慰剂检验)
      - 可以演示如何使用 AI 工具来生成提示词 (prompts)，并展示一些生成的检验方法和代码示例。参考：
        - 陈强, 齐霁, 颜冠鹏, 2025, [双重差分法的安慰剂检验：一个实践的指南](https://kns.cnki.net/kcms2/article/abstract?v=CB7PaufGGSd8bhekSoIG5isMHbV50aQrruikQkxNkz-r6fPx9Y6lYWbsfX8GE60Y6FVi9DQvErNRhRiIv2TZ-3yLEjrbX06WZqYi1qfaVqT-L8j3-HMZbM0_LFRCW2IwkSJzzw95mRdbGXnLmRPxJbGRoIUAwB1-OSjRqgvClcc=&uniplatform=NZKPT).
  - 匹配方法
    - **适用场景**：主要用于应对观察性数据中的选择偏差问题，尤其是在处理组和对照组之间存在显著差异时。注意：匹配方法并不能完全解决内生性问题，尤其是当存在未观测的混淆变量时。
  - **样本选择偏误/自选择偏误**：
     - **区别**：样本选择偏误通常指由于样本选择机制导致的系统性偏差，而自选择偏误则是个体基于自身特征或偏好选择参与某个处理或项目，导致估计结果偏差。
       - 二者的差别在于，样本选择偏误更强调样本的整体选择机制，而自选择偏误则侧重于个体层面的选择行为。
       - 从数据结构上来看，
         - 样本选择偏误主要指的是被解释变量 $y$ 的非随机缺失导致的偏误 (例如，$x$ 中包含 1000 行完整的抽样样本，但 $y$ 中只有 800 行观测值)；模型设定的重点和难点在于：设定一个选择方程，来描述 $y$ 的观测概率 (即选择机制)，并基于此进行修正 (如 Heckman 两步法)。
         - 自选择偏误则更多地涉及解释变量 $x$ 的非随机分配导致的偏误。简言之，模型中的 0/1 处理变量与潜在结果变量相关联，导致估计的处理效应存在偏误。模型设定的重点和难点在于：如何根据问题的具体背景，设计一个合理的处理分配机制。这是设定选择方程的基础。
  - **DDML**：
    - DDML 解决了哪类内生性问题？
      - 主要解决：函数形式误设可能导致的偏误问题，以及高维控制变量下的内生性问题。 
      - 不能解决：遗漏变量偏误和反向因果等传统内生性问题。
    - 演示如何使用 AI 工具来生成提示词 (prompts)，并展示一些生成的代码示例。参考：
      - Chernozhukov, V., Demirer, M., Duflo, E., & Fernández-Val, I. (2022). Double/debiased machine learning for treatment and structural parameters. The Econometrics Journal, 25(1), C1-C68. [Link](https://doi.org/10.1093/ectj/utac001), [PDF](https://arxiv.org/pdf/1608.00060.pdf), [Google](<https://scholar.google.com/scholar?q=Double/debiased+machine+learning+for+treatment+and+structural+parameters>).
  - **文本因果表征** - Imai & Nakamura (2025)
    - 重点：
      - 介绍文本因果表征的基本概念和方法
      - 演示如何使用 AI 工具来生成提示词 (prompts)，并展示一些生成的代码示例。参考：
        - Imai, K., & Nakamura, K. (2025). Causal Representation Learning with Generative Artificial Intelligence: Application to Texts as Treatments (Version 4). arXiv. [Link](https://doi.org/10.48550/arXiv.2410.00903) (rep), [PDF](https://arxiv.org/pdf/2410.00903.pdf), [Google](<https://scholar.google.com/scholar?q=Causal Representation Learning with Generative Artificial Intelligence: Application to Texts as Treatments (Version 4)>).  

- 说明：我希望在介绍各种因果推断方法，如 IV，DDML 等时，可以提供一些基本的公式和图形(如果无法直接制作，可以提供思路)，这样我就可以在两页 slides 中讲清楚一个方法的要点、适用场景、不适用的场景，为后续与 AI 讨论提供基础。我的观念是：如果一个人对这些方法的假设条件和原理不熟悉，他与 AI 对话时是没有自己的主心骨的，会导致对话效率很低。

## 实例

- 选择一个具体的问题，比如「政府引导基金介入与供应链稳定性」，介绍问题背景后，让 AI 工具帮忙识别可能的内生性来源 (如遗漏变量，反向因果等)
  - 问题背景：自 2015 年以来，中国各级政府设立了大量的政府引导基金，旨在通过股权投资等方式支持本地企业的发展，促进产业升级和技术创新。相对于传统的财政补贴和税收优惠，政府引导基金具有资金规模大、市场化程度高等特征。本着「投早、投小、投科技」的原则，旨在支持初创期和成长期的高科技企业。然而，政府引导基金的介入可能会对企业的供应链管理产生复杂的影响。一方面，政府引导基金可能提供资金支持，帮助企业优化库存管理和采购策略，从而增强供应链的稳定性；另一方面，政府引导基金的介入也可能带来行政干预和资源错配，反而加剧供应链的不稳定性。因此，研究政府引导基金介入对企业供应链稳定性的影响具有重要的理论和实践意义。

  - Prompt-Round 1：梳理我说的问题的背景，详细说明 Y, D, X 分别代表什么变量，列出可能存在的主要类型的内生性来源 (遗漏变量，反向因果等)。
    - 输出 1：针对每一种内生性来源，结合我的研究问题，解释为什么会存在这些内生性问题。要分别从文献、制度背景和理论机制三个角度来解释。
    - 输出 2：从论文研究设计的角度，对上述内生性的相对重要性 (严重程度) 进行评估和排序。
    - 目的：
      - (1) 帮助听众理解，识别内生性问题时，不能仅仅停留在列举层面，而要结合具体的研究背景和数据，来评估其严重程度，从而有针对性地设计解决方案。
      - (2) 在一篇论文中，我们通常只能重点解决 1-2 个主要的内生性问题，因此需要对其严重程度进行排序。其他问题可以通过稳健性检验等方式进行辅助说明，但不能遗漏。当然，从策略上来讲，可以留出 1-2 个次要的内生性问题，作为未来研究的方向或等待审稿人的建议。
  
  - Prompt-Round 2：基于上述识别的内生性来源，帮我设计相应的解决方案 (如控制变量法，IV，DID 等)，并解释每种方法的核心假设和检验方法。
    - 输出 1：针对每一种解决方案，结合我的研究问题，解释其核心假设 (如 IV 的相关性和外生性，DID 的平行趋势假设等)，以及常见的检验方法 (如弱 IV 检验，过度识别检验，平行趋势检验等)。
    - 输出 2：帮我生成相应的提示词 (prompts)，以便我可以使用 AI 工具来生成代码示例和进一步的分析思路。
    - 目的：
      - (1) 帮助听众理解，不同的内生性问题需要不同的解决方案，因此在设计研究时，要根据具体的问题选择合适的方法。
      - (2) 强调每种方法都有其核心假设和检验方法，因此在应用时，要确保这些假设得到满足，并进行相应的检验。如果是在研究的早期阶段，就开始考虑这些问题，那么对于数据收集、问卷设计和研究方案的制定都会有指导作用，可以少走很多弯路。
